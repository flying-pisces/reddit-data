<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reddit Data Engine - Live Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <h1>üöÄ Reddit Data Engine</h1>
                <div class="header-controls">
                    <button id="startBtn" class="btn btn-success" onclick="startMonitoring()">
                        ‚ñ∂ Start Monitoring
                    </button>
                    <button id="stopBtn" class="btn btn-danger" onclick="stopMonitoring()" disabled>
                        ‚èπ Stop
                    </button>
                    <button class="btn btn-primary" onclick="refreshData()">
                        üîÑ Refresh
                    </button>
                    <span id="connectionStatus" class="status-indicator">
                        ‚ö´ Disconnected
                    </span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Dashboard -->
    <main class="container">
        <!-- Stats Cards Row -->
        <div class="stats-row">
            <div class="stat-card">
                <div class="stat-title">Total Posts</div>
                <div class="stat-value" id="totalPosts">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">Active Subreddits</div>
                <div class="stat-value" id="activeSubreddits">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">Trending Tickers</div>
                <div class="stat-value" id="trendingTickers">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">Market Sentiment</div>
                <div class="stat-value" id="marketSentiment">Neutral</div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab-button active" onclick="showTab('monitor')">üìä Live Monitor</button>
            <button class="tab-button" onclick="showTab('tickers')">üíπ Tickers</button>
            <button class="tab-button" onclick="showTab('insights')">üí° Insights</button>
            <button class="tab-button" onclick="showTab('export')">üì§ Export</button>
            <button class="tab-button" onclick="showTab('settings')">‚öôÔ∏è Settings</button>
        </div>

        <!-- Tab Content -->
        <div class="tab-content">
            <!-- Monitor Tab -->
            <div id="monitor-tab" class="tab-panel active">
                <div class="monitor-grid">
                    <!-- Live Feed -->
                    <div class="live-feed">
                        <h3>Live Reddit Feed</h3>
                        <div class="feed-controls">
                            <select id="subredditFilter">
                                <option value="all">All Subreddits</option>
                                <option value="wallstreetbets">r/wallstreetbets</option>
                                <option value="stocks">r/stocks</option>
                                <option value="investing">r/investing</option>
                            </select>
                        </div>
                        <div id="postsContainer" class="posts-container">
                            <!-- Posts will be dynamically added here -->
                        </div>
                    </div>

                    <!-- Charts -->
                    <div class="charts-panel">
                        <h3>Activity Chart</h3>
                        <canvas id="activityChart"></canvas>
                        
                        <h3 style="margin-top: 20px;">Top Tickers</h3>
                        <canvas id="tickersChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Tickers Tab -->
            <div id="tickers-tab" class="tab-panel">
                <h3>Trending Stock Tickers</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Ticker</th>
                            <th>Mentions</th>
                            <th>Sentiment</th>
                            <th>Subreddits</th>
                            <th>24h Trend</th>
                        </tr>
                    </thead>
                    <tbody id="tickersTableBody">
                        <!-- Ticker rows will be added here -->
                    </tbody>
                </table>
            </div>

            <!-- Insights Tab -->
            <div id="insights-tab" class="tab-panel">
                <h3>Market Insights</h3>
                <div class="insights-container">
                    <button class="btn btn-primary" onclick="generateInsights()">
                        Generate Insights
                    </button>
                    <div id="insightsContent" class="insights-content">
                        <!-- Insights will be displayed here -->
                    </div>
                </div>
            </div>

            <!-- Export Tab -->
            <div id="export-tab" class="tab-panel">
                <h3>Export Data</h3>
                <div class="export-form">
                    <div class="form-group">
                        <label>Subreddits (comma-separated):</label>
                        <input type="text" id="exportSubreddits" value="wallstreetbets,stocks,investing">
                    </div>
                    <div class="form-group">
                        <label>Hours back:</label>
                        <input type="number" id="exportHours" value="24" min="1" max="168">
                    </div>
                    <button class="btn btn-success" onclick="exportData()">
                        Export to JSON
                    </button>
                    <div id="exportLog" class="export-log">
                        <!-- Export results will be shown here -->
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div id="settings-tab" class="tab-panel">
                <h3>Monitoring Settings</h3>
                <div class="settings-form">
                    <div class="form-group">
                        <label>Refresh Interval (seconds):</label>
                        <input type="range" id="refreshInterval" min="10" max="300" value="30">
                        <span id="refreshValue">30</span>
                    </div>
                    <div class="form-group">
                        <label>Max Posts per Subreddit:</label>
                        <input type="range" id="maxPosts" min="5" max="50" value="25">
                        <span id="maxPostsValue">25</span>
                    </div>
                    <div class="form-group">
                        <label>Monitored Subreddits:</label>
                        <textarea id="monitoredSubreddits" rows="10">wallstreetbets
stocks
investing
options
pennystocks
StockMarket
SecurityAnalysis
ValueInvesting
daytrading</textarea>
                    </div>
                    <button class="btn btn-primary" onclick="saveSettings()">
                        Save Settings
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="container">
            <p>Reddit Data Engine ¬© 2025 | <span id="lastUpdate">Last update: Never</span></p>
        </div>
    </footer>

    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>
</html>